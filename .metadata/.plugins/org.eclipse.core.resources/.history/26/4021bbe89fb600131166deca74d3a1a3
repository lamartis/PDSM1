package com.traitement.integration;
import com.generatedClasses.integration.GetHistoryResponse;
import com.generatedClasses.presentation.ReadHistoryResponse;
import com.generatedClasses.presentation.ReadHistoryResponse.Response;
import com.generatedClasses.presentation.User;
import com.interfaces.M2iInterface;
import com.outils.Codeur;

public class GetHistoryResponseTraitement extends TraitementI{
	GetHistoryResponse getHistoryResponse = (GetHistoryResponse) requete;
	User user;
	
	public GetHistoryResponseTraitement(M2iInterface object, String idMessage, String correlationId){
		super(object, idMessage, correlationId);
	}

	public Void call() throws Exception {

		//Preparer le message d'envoie à la présentation
		ReadHistoryResponse readHistoryResponse = new ReadHistoryResponse();
		readHistoryResponse.setIdentifiant(getHistoryResponse.getIdentifiant());

		Response response = new Response();

		for (String message : getHistoryResponse.getMessage()) {
			response.getMessage().add(message);
		}

		readHistoryResponse.setResponse(response);
		responseXMLMessage = Codeur.convert(readHistoryResponse);

		producerM2P.setMessage(responseXMLMessage, idMessage, idCorrelation);
		poolProducers.submit(producerM2P);
		
		return null;

	}
}
