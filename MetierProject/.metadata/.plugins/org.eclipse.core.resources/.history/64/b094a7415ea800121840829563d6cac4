package com.servlets;

import java.io.IOException;
import java.io.PrintWriter;
import java.io.Writer;
import java.lang.reflect.Constructor;
import java.util.HashMap;
import java.util.Map;
import java.util.Properties;
import java.util.concurrent.ExecutorService;
import java.util.concurrent.Executors;

import javax.naming.Context;
import javax.naming.InitialContext;
import javax.naming.NamingEnumeration;
import javax.servlet.ServletConfig;
import javax.servlet.ServletContext;
import javax.servlet.ServletException;
import javax.servlet.http.HttpServlet;
import javax.servlet.http.HttpServletRequest;
import javax.servlet.http.HttpServletResponse;

import org.apache.activemq.console.Main;

import com.generatedClasses.presentation.User;
import com.interfaces.P2mInterface;
import com.outils.ConnectedUsers;
import com.outils.DecodeurP2M;
import com.traitement.presentation.TraitementP;

public class StartUp extends HttpServlet {
	private static final long serialVersionUID = 1L;
	private ExecutorService pool = Executors.newFixedThreadPool(4);

	public void init(ServletConfig config) throws ServletException{
		
	}//http://tomcat.apache.org/tomcat-6.0-doc/jndi-resources-howto.html
	//http://www.gridshore.nl/blog/index.php?/archives/71-Loading-properties-using-JNDI-within-the-springframework-deployed-on-tomcat.html
	
	protected void service(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {
	/*	try {
			Context ctx = new InitialContext();
			String string = (String) ctx.lookup("java:comp/env/LOGPATH");
			System.out.println(string);
		} catch (Exception e) {
			System.out.println(e.getMessage());
		}
		*/
	/*	String xmlMessage = "<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"yes\"?><connectRequest identifiant=\"192.168.0.1\" xmlns=\"http://www.example.org/Integratipn_Zip\"><user login=\"saad\" password=\"saadd123*\"/></connectRequest>";
		P2mInterface object = DecodeurP2M.convert(xmlMessage);
		try{
			Class<?> classeTemp = Class.forName("com.traitement.presentation." + object.getClass().getSimpleName() + "Traitement") ;
			Constructor<?> classeDeTraitement = classeTemp.getDeclaredConstructor(P2mInterface.class);
			TraitementP traitement = (TraitementP) classeDeTraitement.newInstance(object);
			pool.submit(traitement);	
		
		} catch (Exception e){}
	*/	
		new Main
	}
	
	
/*	public void destroy(){
		pool.shutdown();
	}

*/
}
